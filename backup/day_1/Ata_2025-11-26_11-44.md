# **Ata de Reunião – Projeto ToDo Market & List**

**Data:** 2025-11-26
**Horário:** 11:10:00 – 11:35:00
**Participantes:** Alpha (Gerente), Architect (Tech Lead), Experience, Você

---

## **1. Debate sobre a Criação do “Cérebro” NLP do Sistema**

* **Contexto:** Início das discussões técnicas para criação do módulo de processamento de linguagem natural responsável pela conversão de comandos em texto (“comprar 5kg de arroz”) para o JSON estruturado exigido pela API.
* **Arquivo alvo:** `processador_nlp.py`

---

## **2. Garantia de Saída JSON Válida pelo LLM (Gemini)**

* **Apresentado por:** Alpha (Architect / Tech Lead)

* **Pontos apresentados:**

  1. **Prompt Engineering Estruturado**

     * O modelo deve ser instruído a **retornar exclusivamente JSON**, sem qualquer texto adicional.
     * O prompt deve determinar a estrutura fixa contendo: `nome`, `quantidade`, `unidade`, `categoria`.
  2. **Validação Pós-Processamento**

     * O script tentará realizar `json.loads()` na resposta.
     * Caso a conversão falhe, é sinal de saída inválida.
  3. **Uso de Schema de Saída**

     * Recomenda-se instruir o modelo a seguir um schema pré-definido (não necessariamente um JSON Schema formal).
  4. **Fallback e Retentativas**

     * Retentativas automáticas do prompt caso o JSON seja inválido.
     * Estratégias alternativas (regex) apenas como última opção.
     * Em caso de falha total, retorno de erro claro para o sistema chamador.
  5. **Tratamento de Campos Opcionais**

     * Definir instruções no prompt para lidar com omissões, como categoria indefinida.

* **Status:** Estratégia técnica discutida e validada.

---

## **3. Gestão de Unidades de Medida e Ambiguidades**

* **Pergunta:** “O que acontece se o modelo não entender a unidade de medida?”
* **Discussão:**

  * O prompt deverá orientar o modelo a:

    * **Inferir**, quando possível.
    * **Retornar nulo** ou valor padrão caso a unidade seja desconhecida.
  * O módulo Python poderá complementar a validação, aplicando normalizações ou regras internas.
* **Status:** Diretriz estabelecida; detalhes serão incorporados ao prompt final.

---

## **4. Visão Técnica Reforçada sobre a Arquitetura Geral**

* **Apresentado por:** Architect (Tech Lead)

* **Resumo dos pontos reforçados:**

  * **Orquestração com n8n** como backbone da automação.
  * **Python** como camada de lógica complementar.
  * **IA Resiliente:** Gemini como primário e OpenAI GPT como fallback.
  * **Banco de Dados:** PostgreSQL como principal e SQLite para desenvolvimento.
  * **Frontends de dados:** Notion e Google Workspace como camadas de visualização.
  * **Módulos principais:** Lista de compras, Orçamento Doméstico e Eventos/Tarefas.
  * **Interfaces de entrada:** Telegram (principal) e WhatsApp (rápidas, especialmente áudio).
  * **Desafios técnicos:** Sincronização, performance do n8n, qualidade da extração, escalabilidade.

* **Status:** Marco conceitual reconfirmado e alinhado com o módulo NLP.

---

## **5. Diretrizes para o Desenvolvimento do Arquivo `processador_nlp.py`**

* **Responsável:** A definir (builder ou equipe responsável pela camada NLP)
* **Requisitos consolidados:**

  1. Receber texto natural do usuário.
  2. Formatar instruções para o Gemini com prompt fixo.
  3. Forçar retorno estruturado em JSON.
  4. Validar sintaxe JSON no Python.
  5. Aplicar fallback para o modelo da OpenAI em caso de falha do Gemini.
  6. Implementar lógica de retentativa e tratamento de erros.
* **Status:** Requisitos documentados; desenvolvimento será iniciado na próxima sprint.

---

## **Próximos Passos Sugeridos**

* Definir e versionar o prompt final utilizado pelo script.
* Criar o arquivo inicial `processador_nlp.py` com fluxo base de chamada ao LLM.
* Implementar módulo de validação de JSON e mecanismos de fallback.
* Preparar testes unitários simulando entradas variadas (“3 tomates”, “arroz”, “2 pacote”, etc.).

---

## **Fim da Ata.**
